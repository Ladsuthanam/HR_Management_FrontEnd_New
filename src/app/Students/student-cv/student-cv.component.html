<div class="container-fluid mt-5">
  <div class="row">
    <div class="d-flex justify-content-center align-items-center h-100 w-100 p-5">
      
      <!-- Student Personal Details -->
      <div *ngIf="student; else noData" class="col-md-6">
        <div class="card p-4 shadow-sm border-0">
          <div class="text-center mb-4">
            <img [src]="student.profile || 'https://via.placeholder.com/150'" alt="Profile Image"
              class="img-thumbnail" style="width: 150px; height: 150px; border-radius: 50%;" />
            <h2 class="mt-3">{{ student.firstName }} {{ student.lastName }}</h2>
          </div>
          <hr>
          <div class="content">
            <p>
              <i class="bi bi-person-badge-fill text-primary me-2"></i>
              <strong>Student ID:</strong> {{ student.studentId }}
            </p>
            <p>
              <i class="bi bi-card-text text-primary me-2"></i>
              <strong>NIC:</strong> {{ student.nic }}
            </p>
            <p>
              <i class="bi bi-envelope-fill text-primary me-2"></i>
              <strong>Email:</strong> 
              <a href="mailto:{{ student.email }}" class="text-decoration-none">
                {{ student.email }}
              </a>
            </p>
            <p>
              <i class="bi bi-telephone-fill text-primary me-2"></i>
              <strong>Phone Number:</strong> 
              <a href="tel:{{ student.phoneNumber }}" class="text-decoration-none">
                {{ student.phoneNumber }}
              </a>
            </p>
            <p>
              <i class="bi bi-calendar-date-fill text-primary me-2"></i>
              <strong>Date of Birth:</strong> {{ student.dob | date: 'longDate' }}
            </p>
            <p>
              <i class="bi bi-person-heart text-primary me-2"></i>
              <strong>Marital Status:</strong> {{ student.maritalStatus }}
            </p>
            <p>
              <i class="bi bi-gender-ambiguous text-primary me-2"></i>
              <strong>Gender:</strong> {{ student.gender }}
            </p>

            <div class="mt-4">
              <div *ngIf="studentData.parents">
                <h4><u>Parent Details</u></h4>
                <p><strong>Name: </strong>{{ studentData.parents.firstName }} {{ studentData.parents.lastName }}</p>
                <p><strong>Job: </strong>{{ studentData.parents.job }}</p>
                <p><strong>Contact: </strong>{{ studentData.parents.contactNo }}</p>
                <p><strong>Address: </strong>{{ studentData.parents.address }}</p>
              </div>
            
              <button class="btn btn-outline-primary btn-sm w-100 mb-2"  data-bs-toggle="modal" data-bs-target="#ParentsModal">
                <i class="bi bi-people-fill me-1"></i> + Add Parents
              </button>
            
              <div *ngIf="studentData.address; else noAddress">
                <h4><u>Address</u></h4>
                <ul>
                  <p><strong>House Number:</strong> {{ studentData.address.houseNumber }}</p>
                  <p><strong>Street:</strong> {{ studentData.address.street }}</p>
                  <p><strong>Lane:</strong> {{ studentData.address.lane }}</p>
                  <p><strong>City:</strong> {{ studentData.address.city }}</p>
                  <p><strong>State:</strong> {{ studentData.address.state }}</p>
                  <p><strong>Postal Code:</strong> {{ studentData.address.postalCode }}</p>
                  <p><strong>Country:</strong> {{ studentData.address.country }}</p>
                </ul>
                <!-- Edit Address Button -->
                <button class="btn btn-outline-primary btn-sm w-100 mt-3" data-bs-toggle="modal" data-bs-target="#Address">
                  <i class="bi bi-geo-alt-fill me-1"></i> Edit Address
                </button>
              </div>
            
              <!-- Show when no address data exists -->
              <ng-template #noAddress>
                <button class="btn btn-outline-primary btn-sm w-100 mt-3" data-bs-toggle="modal" data-bs-target="#Address" data-bs-dismiss="modal">
                  <i class="bi bi-geo-alt-fill me-1"></i> + Add Address
                </button>
              </ng-template>
            </div>
            
          </div>
        </div>
      </div>

      <!-- Student Education Qualifications -->
      <div class="col-md-6">
        <div class="card p-4 shadow-sm border-0">
          <div class="mb-3">
            <button class="btn btn-outline-primary btn-sm w-100" data-bs-toggle="modal" data-bs-target="#olQualification">
              <i class="bi bi-book-half me-1"></i> + Add OLevel Qualification
            </button>
          </div>
          <div class="mb-3">
            <button class="btn btn-outline-primary btn-sm w-100" data-bs-toggle="modal" data-bs-target="#AlQualification">
              <i class="bi bi-journal-text me-1"></i> + Add ALevel Qualification
            </button>
          </div>
          <div class="mb-3">
            <button class="btn btn-outline-primary btn-sm w-100" data-bs-toggle="modal" data-bs-target="#HigherStudy">
              <i class="bi bi-mortarboard-fill me-1"></i> + Add Higher Study
            </button>
          </div>
          <div>
            <button class="btn btn-outline-primary btn-sm w-100" data-bs-toggle="modal" data-bs-target="#Experience">
              <i class="bi bi-briefcase-fill me-1"></i> + Add Work Experience
            </button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- No Data Template -->
  <ng-template #noData>
    <div class="text-center">
      <p class="text-danger fw-bold">No student details found.</p>
    </div>
  </ng-template>
</div>



<!-- Modal -->
<!-- Parents Modal -->
<div class="modal fade" id="ParentsModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form [formGroup]="parentsForm" (ngSubmit)="saveData(parentsForm, 'parents')">
        <div class="modal-header">
          <h5 class="modal-title">Add Parents</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="firstName" class="form-label">First Name</label>
            <input type="text" id="firstName" class="form-control" formControlName="firstName" />
          </div>
          <div class="mb-3">
            <label for="lastName" class="form-label">Last Name</label>
            <input type="text" id="lastName" class="form-control" formControlName="lastName" />
          </div>
          <div class="mb-3">
            <label for="job" class="form-label">Job</label>
            <input type="text" id="job" class="form-control" formControlName="job" />
          </div>
          <div class="mb-3">
            <label for="contactNo" class="form-label">Contact Number</label>
            <input type="text" id="contactNo" class="form-control" formControlName="contactNo" />
          </div>
          <div class="mb-3">
            <label for="address" class="form-label">Address</label>
            <input type="text" id="address" class="form-control" formControlName="address" />
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary" data-bs-dismiss="modal" >Save Changes</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Address Modal -->
<div class="modal fade" id="Address" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form [formGroup]="addressForm" (ngSubmit)="saveAddress()">
        <div class="modal-header">
          <h5 class="modal-title">Add Address</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3" *ngFor="let field of addressFields">
            <label [for]="field.id" class="form-label">{{ field.label }}</label>
            <input
              type="text"
              [id]="field.id"
              class="form-control"
              [placeholder]="field.placeholder"
              [formControlName]="field.id"
            />
            <div 
              *ngIf="addressForm.get(field.id)?.invalid && addressForm.get(field.id)?.touched" 
              class="text-danger">
              {{ field.error }}
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary" [disabled]="addressForm.invalid" data-bs-dismiss="modal">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="AlQualification" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="olQualification" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="HigherStudy" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="Experience" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>